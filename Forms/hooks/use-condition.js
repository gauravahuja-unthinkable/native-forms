var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.useCondition=useCondition;var _toConsumableArray2=_interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray")),_slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray")),_react=require("react"),_utils=require("../utils"),_helpers=require("../blocks/helpers");function checkFormConditionsStatus(a){var b=(0,_utils.returnFormValidConditions)(a),c=!1;if(0===b.length)return{conditions:b,hasChanges:c};var d=(0,_helpers.returnFormData)(a);return b.forEach(function(a){var b=a.type,e=a.value,f=a.conditionQuestion,g=a.canShow;if("has any value"===b){var h=!!d[f];g!==h&&(c=!0),a.canShow=h}if("is equal to"===b){var i=!!d[f]&&d[f].toString()===e.toString();g!==i&&(c=!0),a.canShow=i}if("includes"===b){var j=!!d[f]&&d[f].toString().includes(e.toString());g!==j&&(c=!0),a.canShow=j}}),{conditions:b,hasChanges:c}}function useCondition(a){var b=(0,_react.useState)(checkFormConditionsStatus(a).conditions),c=(0,_slicedToArray2.default)(b,2),d=c[0],e=c[1],f=(0,_react.useState)(0<(0,_utils.returnFormValidConditions)(a).length),g=(0,_slicedToArray2.default)(f,2),h=g[0],i=g[1],j=(0,_react.useCallback)(function(){if(h){var b=checkFormConditionsStatus(a),c=b.conditions,d=b.hasChanges;d&&e((0,_toConsumableArray2.default)(c))}},[a,h]);return(0,_react.useEffect)(function(){i(0<(0,_utils.returnFormValidConditions)(a).length),e(checkFormConditionsStatus(a).conditions)},[a]),{conditions:d,onFormValueChange:j}}