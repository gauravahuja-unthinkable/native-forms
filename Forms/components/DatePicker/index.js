var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard"),_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _objectSpread4=_interopRequireDefault(require("@babel/runtime/helpers/objectSpread")),_classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck")),_createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass")),_possibleConstructorReturn2=_interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn")),_getPrototypeOf2=_interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf")),_assertThisInitialized2=_interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized")),_inherits2=_interopRequireDefault(require("@babel/runtime/helpers/inherits")),_toArray2=_interopRequireDefault(require("@babel/runtime/helpers/toArray")),_react=_interopRequireWildcard(require("react")),_reactNative=require("react-native"),_DatePickerItem=_interopRequireDefault(require("./DatePickerItem.js")),_pureRender=_interopRequireDefault(require("./pureRender.js")),_time=require("./time.js"),_dataSource=require("./dataSource"),capitalize=function(a){var b=(0,_toArray2.default)(a),c=b[0],d=b.slice(1);return c.toUpperCase()+d.join("")},isArray=function(a){return"[object Array]"===Object.prototype.toString.apply(a)},DatePicker=function(a){function b(a){var c;return(0,_classCallCheck2.default)(this,b),c=(0,_possibleConstructorReturn2.default)(this,(0,_getPrototypeOf2.default)(b).call(this,a)),c.state={value:(0,_time.nextDate)(c.props.value)},c.handleDateSelect=c.handleDateSelect.bind((0,_assertThisInitialized2.default)(c)),c}return(0,_inherits2.default)(b,a),(0,_createClass2.default)(b,[{key:"componentWillReceiveProps",value:function componentWillReceiveProps(a){var b=(0,_time.nextDate)(a.value);b.getTime()!==this.state.value.getTime()&&this.setState({value:b})}},{key:"componentDidUpdate",value:function componentDidUpdate(){var a=this.state.value,b=this.props,c=b.min,d=b.max;a.getTime()>d.getTime()&&this.setState({value:d}),a.getTime()<c.getTime()&&this.setState({value:c})}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(a,b){var c=(0,_time.nextDate)(b.value);return c.getTime()!==this.state.value.getTime()||_pureRender.default.shouldComponentUpdate(a,b,this.props,this.state)}},{key:"handleDateSelect",value:function handleDateSelect(a){var b=this;this.setState({value:a},function(){b.props.onChange(a)})}},{key:"normalizeDateConfig",value:function normalizeDateConfig(a){var b=[];if(isArray(a)){for(var c,d=0;d<a.length;d++)if(c=a[d],"string"==typeof c){var e=c.toLocaleLowerCase();b.push((0,_objectSpread4.default)({},_dataSource.dateConfigMap[e],{type:capitalize(e)}))}}else for(var f in a)if(a.hasOwnProperty(f)){var g=f.toLocaleLowerCase();_dataSource.dateConfigMap.hasOwnProperty(g)&&b.push((0,_objectSpread4.default)({},_dataSource.dateConfigMap[g],{},a[f],{type:capitalize(g)}))}return b}},{key:"render",value:function render(){var a=this,b=this.props,c=b.min,d=b.max,e=b.dateConfig,f=b.color,g=b.textColor,h=b.isPreview,i=this.state.value,j=this.normalizeDateConfig(e),k={color:g+"99"};return _react.default.createElement(_reactNative.View,{style:styles.container},_react.default.createElement(_reactNative.View,{style:styles.captionContainer},j.map(function(a,b){return _react.default.createElement(_reactNative.Text,{key:b,style:[styles.caption,k]},a.caption)})),_react.default.createElement(_reactNative.View,{style:styles.content},j.map(function(b,e){return _react.default.createElement(_DatePickerItem.default,{key:e,value:i,min:c,max:d,step:b.step,type:b.type,format:b.format,color:f,textColor:g,onSelect:a.handleDateSelect,isPreview:h})})))}}]),b}(_react.Component),styles=_reactNative.StyleSheet.create({container:{width:"100%"},captionContainer:{display:"flex",flexDirection:"row",paddingTop:8,paddingHorizontal:4},caption:{flex:1,marginHorizontal:4,textAlign:"center",height:30,lineHeight:30,fontSize:16},content:{display:"flex",flexDirection:"row",paddingVertical:8,paddingHorizontal:4}});DatePicker.defaultProps=_dataSource.defaultProps;var _default=DatePicker;exports.default=_default;