var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard"),_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _objectSpread3=_interopRequireDefault(require("@babel/runtime/helpers/objectSpread")),_extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray")),_objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties")),_react=_interopRequireWildcard(require("react")),_reactNative=require("react-native"),_LoadingError=require("./LoadingError"),_index=_interopRequireDefault(require("../index")),_eventEmitter=require("../api/event-emitter"),_MobileContainer=_interopRequireDefault(require("./MobileContainer")),_Toast=require("./Toast/Toast"),_ToastWrapper=_interopRequireDefault(require("./Toast/ToastWrapper")),_theme=require("../theme"),_Header=_interopRequireDefault(require("./Header")),_ProgressBar=_interopRequireDefault(require("./ProgressBar")),IFrameContainer=function(a){var b=a.error,c=a.form,d=a.onClose,e=a.onSend,f=a.livePreview,g=a.onBeforeSend,h=a.noInternetConnection,i=a.showSelectionDialog,j=(0,_objectWithoutProperties2.default)(a,["error","form","onClose","onSend","livePreview","onBeforeSend","noInternetConnection","showSelectionDialog"]),k=(0,_react.useState)(!1),l=(0,_slicedToArray2.default)(k,2),m=l[0],n=l[1],o=(0,_react.useState)(!1),p=(0,_slicedToArray2.default)(o,2),q=p[0],r=p[1],s=(0,_react.useState)(new _reactNative.Animated.Value(0)),t=(0,_slicedToArray2.default)(s,1),u=t[0],v=(0,_react.useState)(new _reactNative.Animated.Value(.5)),w=(0,_slicedToArray2.default)(v,1),x=w[0],y=(0,_react.useState)(new _reactNative.Animated.Value(0)),z=(0,_slicedToArray2.default)(y,1),A=z[0],B=(0,_react.useCallback)(function(){u.setValue(1),x.setValue(1),_reactNative.Animated.parallel([_reactNative.Animated.timing(u,{toValue:0,duration:300,easing:_reactNative.Easing.out(_reactNative.Easing.quad),useNativeDriver:!0}),_reactNative.Animated.timing(x,{toValue:0,duration:300,easing:_reactNative.Easing.out(_reactNative.Easing.quad),useNativeDriver:!0})]).start(function(){d(),(0,_eventEmitter.form_closed)()})},[d,u,x]);if((0,_react.useEffect)(function(){var a=function(a){return 27===a.keyCode&&B()};return document.addEventListener("keyup",a,!0),function(){document.removeEventListener("keyup",a,!0)}},[B]),(0,_react.useEffect)(function(){(c||b)&&((0,_eventEmitter.form_loaded)(),_reactNative.Animated.parallel([_reactNative.Animated.timing(u,{toValue:1,duration:500,easing:_reactNative.Easing.out(_reactNative.Easing.quad),useNativeDriver:!0}),_reactNative.Animated.timing(x,{toValue:1,duration:500,easing:_reactNative.Easing.out(_reactNative.Easing.quad),useNativeDriver:!0}),_reactNative.Animated.timing(A,{toValue:1,delay:500,duration:700,easing:_reactNative.Easing.out(_reactNative.Easing.quad),useNativeDriver:!0})]).start())},[b,c,u,x,A]),500>=window.innerWidth)return _react.default.createElement(_MobileContainer.default,(0,_extends2.default)({onSend:e,onBeforeSend:g,error:b,form:c,onClose:B,livePreview:f,noInternetConnection:h,showSelectionDialog:i,iframe:!0},j));var C=(c||{}).backgroundColor,D=void 0===C?_theme.colors.white:C;return _react.default.createElement(_reactNative.TouchableOpacity,{onPress:function onOverlayClick(a){return a.target===a.currentTarget&&B()},activeOpacity:1,style:styles.overlay},b&&_react.default.createElement(_reactNative.Animated.View,{style:[{opacity:u,transform:[{scale:x}]},styles.container]},_react.default.createElement(_Header.default,{form:c,onClose:B}),_react.default.createElement(_LoadingError.LoadingError,{iframe:!0,error:b})),!b&&c&&_react.default.createElement(_reactNative.Animated.View,{style:[{opacity:u,transform:[{scale:x}]},{backgroundColor:D},styles.container]},_react.default.createElement(_reactNative.Animated.View,{style:{opacity:A}},_react.default.createElement(_Header.default,{form:c,onClose:B}),m&&_react.default.createElement(_ProgressBar.default,{form:c}),_react.default.createElement(_index.default,(0,_extends2.default)({onSend:function _onFormSend(){n(!0),e&&e(),setTimeout(function(){B()},2e3)},onBeforeSend:g,form:c,iframe:!0,livePreview:f,showError:r,noInternetConnection:h,showSelectionDialog:i},j)))),_react.default.createElement(_ToastWrapper.default,{verticalPosition:"top",horizontalPosition:"center"},q&&_react.default.createElement(_Toast.Toast,{variant:"error",onClose:function(){return r(!1)},duration:2e3,removable:!0},q)))},cursor="web"===_reactNative.Platform.OS?{cursor:"default"}:{},styles=_reactNative.StyleSheet.create({overlay:(0,_objectSpread3.default)({position:"web"===_reactNative.Platform.OS?"fixed":"absolute",overflow:"scroll",top:0,left:0,right:0,bottom:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",backgroundColor:"transparent",zIndex:9e5},cursor),container:{position:"relative",width:"94%",maxWidth:730,marginVertical:50,paddingHorizontal:2,paddingVertical:2,borderRadius:8}});IFrameContainer.defaultProps={onClose:function onClose(){}};var _default=(0,_react.memo)(IFrameContainer);exports.default=_default;